<div class="quote-container">
  <div class="quote-beautiful" style="display:flex;align-items:center;justify-content:space-between;">
  <h1 style="margin:0;">{{companyName ? companyName + ' Quotation' : 'Quotation'}}</h1>
    <div style="display:flex;align-items:center;">
  <input type="file" #logoInput accept="image/*" style="display:none;" (change)="onLogoSelected($event)" />
      <div style="width:2px;height:32px;background:#ccc;margin:0 20px;"></div>
      <div>
        <a *ngIf="!showCompanyInfo || !showClientInfo || !showPillingInfo || !showPlinthInfo"
           href="#"
           (click)="$event.preventDefault(); expandAll()"
           style="margin-right:16px;">Expand All</a>
        <a *ngIf="showCompanyInfo && showClientInfo && showPillingInfo && showPlinthInfo"
           href="#"
           (click)="$event.preventDefault(); collapseAll()">Collapse All</a>
      </div>
    </div>
  <!-- Display uploaded logo if available -->
  <div *ngIf="logoUrl" style="margin:16px 0;display:flex;flex-direction:column;align-items:center;">
    <img [src]="logoUrl" alt="Logo" style="max-height:80px;max-width:220px;object-fit:contain;border-radius:8px;box-shadow:0 2px 8px #ccc;" />
    <button *ngIf="logoUrl" type="button" (click)="logoInput.click()" style="background:none;border:none;color:#1976d2;text-decoration:underline;cursor:pointer;font-size:14px;margin-top:8px;">Edit Logo</button>
  </div>
  <button *ngIf="!logoUrl" type="button" (click)="logoInput.click()" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:6px 18px;cursor:pointer;margin-right:16px;">Add Logo</button>
  <!-- Generate Quotation Button -->

  <!-- Quotation Summary Display -->
  <div *ngIf="showQuotationSummary" style="margin:32px auto;max-width:900px;padding:32px 24px;background:#f7f7f7;border-radius:12px;box-shadow:0 2px 12px #ccc;">
    <h2 style="color:#1976d2;margin-bottom:24px;">Quotation Summary</h2>
    <div>
      <!-- Display all relevant info here, e.g. company, client, totals, etc. -->
      <p><strong>Company Name:</strong> {{companyName}}</p>
      <p><strong>Client Name:</strong> {{clientPrefix}} {{clientName}}</p>
      <p><strong>Location:</strong> {{clientLocation}}</p>
      <p><strong>Total Project Cost:</strong> <span style="color:#388e3c;font-size:22px;font-weight:bold;">{{calculateTotalProjectCost() | number:'1.0-0'}}</span></p>
      <!-- Add more details as needed -->
    </div>
  </div>
  </div>

  <hr style="border:0;border-top:2px solid #ccc;margin:24px 0;" />

  <!-- Company Info -->
  <div class="company-section">
    <button class="company-toggle" type="button" (click)="toggleCompanyInfo()">
      <span>Company Info</span>
      <span class="arrow" [class.open]="showCompanyInfo">&#9660;</span>
    </button>

    <div class="company-details" *ngIf="showCompanyInfo">
      <div class="company-info-row">
        <label for="companyName">Company Name</label>
        <input id="companyName" type="text" class="company-input" [(ngModel)]="companyName" />
      </div>

      <div class="company-info-row">
        <label for="companyAddress">Address</label>
        <input id="companyAddress" type="text" class="company-input" [(ngModel)]="companyAddress" />
      </div>

      <div class="company-info-row">
        <label for="companyMobile">Mobile</label>
        <input id="companyMobile" type="tel" class="company-input" [(ngModel)]="companyMobile" />
      </div>

      <div class="section-actions">
        <button class="company-reset-btn" type="button" (click)="resetCompanyInfo()">Reset</button>
      </div>
    </div>
  </div>

  <!-- Client Info -->
  <div class="company-section">
    <button class="company-toggle" type="button" (click)="toggleClientInfo()">
      <span>Client Info</span>
      <span class="arrow" [class.open]="showClientInfo">&#9660;</span>
    </button>

    <div class="company-details" *ngIf="showClientInfo">
      <div class="company-info-row inline">
        <label for="clientPrefix">Prefix</label>
        <select id="clientPrefix" [(ngModel)]="clientPrefix" class="company-input select-input">
          <option value="Mr">Mr</option>
          <option value="Mrs">Mrs</option>
        </select>

        <input id="clientName" type="text" class="company-input" [(ngModel)]="clientName" placeholder="Full name" />
      </div>

      <div class="company-info-row">
        <label for="clientEmail">Email</label>
        <input id="clientEmail" type="email" class="company-input" [(ngModel)]="clientEmail" />
      </div>

      <div class="company-info-row">
        <label for="clientContact">Contact</label>
        <input id="clientContact" type="tel" class="company-input" [(ngModel)]="clientContact" />
      </div>

      <div class="company-info-row">
        <label for="clientLocation">Location</label>
        <input id="clientLocation" type="text" class="company-input" [(ngModel)]="clientLocation" />
      </div>

      <div class="section-actions">
        <button class="company-reset-btn" type="button" (click)="resetClientInfo()">Reset</button>
      </div>
    </div>
  </div>

  <!-- Piling Foundation (kept once, above plinth) -->
  <!-- Piling Foundation (kept once, above plinth) -->
  <div class="company-section">
    <div style="display: flex; align-items: center; justify-content: space-between;">
      <button class="company-toggle" type="button" (click)="isPillingRequired && togglePillingInfo()" [disabled]="!isPillingRequired" style="flex:1;">
        <span [style.color]="isPillingRequired ? 'inherit' : '#aaa'">Piling Foundation</span>
        <span class="arrow" [class.open]="showPillingInfo" [style.color]="isPillingRequired ? 'inherit' : '#aaa'">&#9660;</span>
      </button>
      <label style="font-weight:bold; margin-left: 16px; white-space:nowrap;">
        <input type="checkbox" [(ngModel)]="isPillingRequired" /> Required
      </label>
    </div>

    <div class="company-details" *ngIf="showPillingInfo && isPillingRequired">
      <div class="company-info-row">
        <label for="pillingMaterial">Material Information</label>
        <input id="pillingMaterial" type="text" class="company-input" [(ngModel)]="pillingMaterial" placeholder="Enter material details" [disabled]="!isPillingRequired" />
      </div>
      <div class="company-info-row">
        <label for="pileType">Pile Type</label>
        <input id="pileType" type="text" class="company-input" [(ngModel)]="pileType" placeholder="Type of pile" [disabled]="!isPillingRequired" />
      </div>

      <div class="company-info-row">
        <label for="pileDepth">Pile Depth (ft)</label>
        <input id="pileDepth" type="number" class="company-input" [(ngModel)]="pileDepth" placeholder="Depth in feet" [disabled]="!isPillingRequired" />
      </div>

      <div class="company-info-row">
        <label for="pileCount">Number of Piles</label>
        <input id="pileCount" type="number" class="company-input" [(ngModel)]="pileCount" placeholder="Total piles" [disabled]="!isPillingRequired" />
      </div>

      <div class="company-info-row">
        <label for="pilePrice">Price Per Feet (Rs.)</label>
        <div style="display:flex;align-items:center;gap:16px;">
          <input id="pilePrice" type="number" class="company-input" [(ngModel)]="pilePrice" placeholder="Price per feet" style="width:30%;max-width:180px;" [disabled]="!isPillingRequired" />
          <label style="font-weight:bold;" for="pileTotalCost">Total Cost</label>
          <input id="pileTotalCost"
                 type="number"
                 class="company-input"
                 [value]="( (pileDepth || 0) * (pileCount || 0) * (pilePrice || 0) )"
                 readonly
                 style="width:30%;max-width:180px;font-weight:bold;" />
        </div>
      </div>

      <div class="section-actions">
        <button class="company-reset-btn" type="button" (click)="resetPillingInfo()" [disabled]="!isPillingRequired">Reset</button>
      </div>
    </div>
  </div>

  <!-- Plinth / Foundation Work (placed immediately below Piling) -->
  <div class="company-section">
    <button class="company-toggle" type="button" (click)="togglePlinthInfo()">
      <span>Plinth / Foundation Work</span>
      <span class="arrow" [class.open]="showPlinthInfo">&#9660;</span>
    </button>

    <div class="company-details" *ngIf="showPlinthInfo">
      <div class="company-info-row">
        <label for="plinthMaterial">Material Information</label>
        <input id="plinthMaterial" type="text" class="company-input" [(ngModel)]="plinthMaterial" placeholder="Enter material details" />
      </div>

      <div class="company-info-row">
        <label for="plinthBaseSqft">Total Base Square Ft</label>
        <input id="plinthBaseSqft" type="text" class="company-input" [(ngModel)]="plinthBaseSqft" placeholder="Base Sq Ft" style="width:30%;max-width:180px;" />
      </div>
      <div class="company-info-row">
        <label for="plinthSqftPrice">Sq Ft Price</label>
        <input id="plinthSqftPrice" type="text" class="company-input" [(ngModel)]="plinthSqftPrice" placeholder="Price per Sq Ft" style="width:30%;max-width:180px;" />
      </div>
      <div class="company-info-row">
  <label for="plinthTotalCost" style="font-weight:bold;">Total Cost</label>
  <input id="plinthTotalCost" type="text" class="company-input" [value]="plinthBaseSqft * plinthSqftPrice" readonly style="width:30%;max-width:180px;font-weight:bold;" />
        </div>

      <div class="section-actions">
        <button class="company-reset-btn" type="button" (click)="resetPlinthInfo()">Reset</button>
      </div>
    </div>
  </div>

  <!-- single router outlet at bottom -->
  <router-outlet></router-outlet>

<!-- Super Structure Ground Floor Section -->
<div class="company-section">
  <button class="company-toggle" type="button" (click)="showSuperStructureInfo = !showSuperStructureInfo">
    <span>Super Structure</span>
    <span class="arrow" [class.open]="showSuperStructureInfo">&#9660;</span>
  </button>

  <div class="company-details" *ngIf="showSuperStructureInfo">
    <h3 style="margin-top:0;margin-bottom:16px;color:#1976d2;font-size:22px;font-weight:600;">Ground Floor</h3>
    <div class="company-info-row">
      <label for="superStructureMaterial">Branded Material</label>
      <input id="superStructureMaterial" type="text" class="company-input" [(ngModel)]="superStructureMaterial" placeholder="Enter material details" style="width:100%;max-width:1000px;" [value]="'Wall finish (Asian/Birla Putty), Premium Paint (Asian Paint + Weather Coat). Electrical: Finolex/Anchor/Havells. Flooring: Somany Tiles (4x2). Staircase: Marble. Inside doors: 30mm Ply waterproof. Main Door: Teak. Kitchen chimney: Branded. Chowkath: WPC (5”x2.5”). Windows: PVC with mosquito cover & glass. Plumbing: Oriplast/Supreme, Jaguar. Grills: GI. Balcony: SS. Kitchen slab: Granite'" />
    </div>
    <div class="company-info-row">
      <label for="superStructureMaterial2">Non Branded Material</label>
      <input id="superStructureMaterial2" type="text" class="company-input" [(ngModel)]="superStructureMaterial2" placeholder="Enter material details" style="width:100%;max-width:1000px;" />
    </div>
    <div class="company-info-row">
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; align-items: center;">
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
          <label for="superStructureBaseSqft" style="margin-bottom:4px;font-weight:500;">Total Base Part size in Sq ft</label>
          <div style="display:flex;align-items:center;">
            <input id="superStructureBaseSqft" type="number" class="company-input" [(ngModel)]="superStructureBaseSqft" placeholder="Total Base" style="width:180px;" (ngModelChange)="onSuperStructureBaseSqftChange($event)" (blur)="enforceSuperStructureBounds()" />
            <span style="font-size:20px;margin-left:8px;">=</span>
          </div>
        </div>
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
          <label for="coreHouseSqft" style="margin-bottom:4px;font-weight:500;white-space:nowrap;font-size:15px;">Core House Part size in Sq ft</label>
          <div style="display:flex;align-items:center;">
            <input id="coreHouseSqft" type="number" class="company-input" [(ngModel)]="coreHouseSqft" placeholder="Core House" style="width:180px;" (ngModelChange)="onCoreHouseSqftChange($event)" (blur)="enforceSuperStructureBounds()" [attr.max]="superStructureBaseSqft || null" />
            <span style="font-size:20px;margin-left:8px;">+</span>
          </div>
          <label for="coreHouseSqftPrice" style="margin-top:8px;font-size:14px;">Sq Ft Price</label>
          <input id="coreHouseSqftPrice" type="number" class="company-input" [(ngModel)]="coreHouseSqftPrice" placeholder="Sq Ft Price" style="width:180px;" />
          <div style="margin-top:8px; display:flex; align-items:center; gap:12px;">
            <label for="coreHouseTotal" style="font-size:14px; font-weight:bold;">Total (Rs.)</label>
            <input id="coreHouseTotal" type="text" class="company-input" [value]="(coreHouseSqft || 0) * (coreHouseSqftPrice || 0)" readonly style="width:180px;font-weight:bold;" />
          </div>
        </div>
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
          <label for="finishingSqft" style="margin-bottom:4px;font-weight:500;">Finishing Part size in Sq ft</label>
          <input id="finishingSqft" type="number" class="company-input" [(ngModel)]="finishingSqft" placeholder="Finishing" style="width:320px;max-width:320px;" readonly />
          <div style="margin-top:8px; display: flex; align-items: center; gap: 16px;">
            <label style="font-size:14px; margin-right:16px; white-space:nowrap;">Sq Ft Price</label>
            <div style="display:flex;flex-direction:column;gap:8px;min-width:120px;">
              <label style="display:flex;align-items:center;gap:8px;">
                <input type="radio" name="finishingPriceType" [(ngModel)]="finishingPriceType" (change)="onFinishingPriceTypeChange(finishingPriceType)" [value]="'branded'" id="radioBranded" />
                Branded
              </label>
              <label style="display:flex;align-items:center;gap:8px;">
                <input type="radio" name="finishingPriceType" [(ngModel)]="finishingPriceType" (change)="onFinishingPriceTypeChange(finishingPriceType)" [value]="'nonbranded'" id="radioNonBranded" />
                Non Branded
              </label>
            </div>
            <input id="finishingPrice"
                   type="number"
                   class="company-input"
                   [(ngModel)]="finishingPrice"
                   style="width:120px; margin-left:24px;"
                   aria-label="Finishing price per sqft (editable)" />
          </div>
          <div style="margin-top:8px; display:flex; align-items:center; gap:12px;">
            <label for="finishingTotal" style="font-size:14px; font-weight:bold;">Total (Rs.)</label>
            <input id="finishingTotal" type="text" class="company-input" [value]="(finishingSqft || 0) * (finishingPrice || 0)" readonly style="width:180px;font-weight:bold;" />
          </div>
        </div>
      </div>
    </div>

    <!-- Validation: ensure Core + Finishing does not exceed Base -->
    <div class="company-info-row" *ngIf="(((coreHouseSqft || 0) + (finishingSqft || 0)) > (superStructureBaseSqft || 0))">
      <span style="color:#d32f2f;font-weight:600;">Sum of Core House and Finishing ({{(coreHouseSqft || 0) + (finishingSqft || 0)}}) exceeds Total Base size ({{superStructureBaseSqft || 0}}).</span>
    </div>
 
    <div class="company-info-row">
  <label for="superStructureTotalCost" style="font-weight:bold;">Total Cost</label>
  <input id="superStructureTotalCost" type="text" class="company-input" [value]="(coreHouseSqft * coreHouseSqftPrice) + (finishingSqft * finishingPrice)" readonly style="width:30%;max-width:180px;font-weight:bold;" />
    </div>
    <div class="section-actions">
      <button class="company-reset-btn" type="button" (click)="resetSuperStructureInfo()">Reset</button>
    </div>
    <!-- Dynamic Floors Container -->
    <div *ngFor="let floor of floors; let i = index" class="company-section" style="margin-top:32px;">
      <div style="display:flex;align-items:center;justify-content:space-between;">
        <button class="company-toggle" type="button" (click)="toggleFloorInfo(i)" style="flex:1;">
          <span>Floor {{i+1}}</span>
          <span class="arrow" [class.open]="floor.showInfo">&#9660;</span>
        </button>
        <button type="button" (click)="deleteFloor(i)" style="background:#e53935;color:#fff;border:none;border-radius:4px;padding:4px 12px;cursor:pointer;margin-left:12px;">Delete</button>
      </div>
      <div class="company-details" *ngIf="floor.showInfo">
  <h3 style="margin-top:0;margin-bottom:16px;color:#1976d2;font-size:22px;font-weight:600;">{{i+1 === 1 ? '1st' : i+1 === 2 ? '2nd' : i+1 === 3 ? '3rd' : i+1 + 'th'}} Floor</h3>
        <div class="company-info-row" *ngIf="floor.finishingPriceType === 'branded'">
          <label>Branded Material</label>
          <input type="text" class="company-input" [(ngModel)]="floor.brandedMaterial" placeholder="Enter material details" style="width:100%;max-width:1000px;" />
        </div>
        <div class="company-info-row" *ngIf="floor.finishingPriceType === 'nonbranded'">
          <label>Non Branded Material</label>
          <input type="text" class="company-input" [(ngModel)]="floor.nonBrandedMaterial" placeholder="Enter material details" style="width:100%;max-width:1000px;" />
        </div>
        <div class="company-info-row">
          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; align-items: center;">
            <div style="display: flex; flex-direction: column; align-items: flex-start;">
              <label style="margin-bottom:4px;font-weight:500;">Total Base Part size in Sq ft</label>
              <div style="display:flex;align-items:center;">
                <input type="number" class="company-input" [(ngModel)]="floor.baseSqft" placeholder="Total Base" style="width:180px;" [value]="1500" (ngModelChange)="onFloorBaseSqftChange(i, $event)" (blur)="enforceFloorBounds(i)" />
                <span style="font-size:20px;margin-left:8px;">=</span>
              </div>
            </div>
            <div style="display: flex; flex-direction: column; align-items: flex-start;">
              <label style="margin-bottom:4px;font-weight:500;white-space:nowrap;font-size:15px;">Core House Part size in Sq ft</label>
              <div style="display:flex;align-items:center;">
                <input type="number" class="company-input" [(ngModel)]="floor.coreHouseSqft" placeholder="Core House" style="width:180px;" [value]="0" (ngModelChange)="onFloorCoreHouseSqftChange(i, $event)" (blur)="enforceFloorBounds(i)" [attr.max]="floor.baseSqft || null" />
                <span style="font-size:20px;margin-left:8px;">+</span>
              </div>
              <label style="margin-top:8px;font-size:14px;">Sq Ft Price</label>
              <input type="number" class="company-input" [(ngModel)]="floor.coreHouseSqftPrice" placeholder="Sq Ft Price" style="width:180px;" />
              <div style="margin-top:8px; display:flex; align-items:center; gap:12px;">
                <label style="font-size:14px; font-weight:bold;">Total (Rs.)</label>
                <input type="text" class="company-input" [value]="(floor.coreHouseSqft || 0) * (floor.coreHouseSqftPrice || 0)" readonly style="width:180px;font-weight:bold;" />
              </div>
            </div>
            <div style="display: flex; flex-direction: column; align-items: flex-start;">
              <label style="margin-bottom:4px;font-weight:500;">Finishing Part size in Sq ft</label>
              <input type="number" class="company-input" [(ngModel)]="floor.finishingSqft" placeholder="Finishing" style="width:320px;max-width:320px;" [value]="1500" readonly />
              <div style="margin-top:8px; display: flex; align-items: center; gap: 16px;">
                <label style="font-size:14px; margin-right:16px; white-space:nowrap;">Sq Ft Price</label>
                <div style="display:flex;flex-direction:column;gap:8px;min-width:120px;">
                  <label style="display:flex;align-items:center;gap:8px;">
                    <input type="radio"
                           name="finishingPriceType{{i}}"
                           [(ngModel)]="floor.finishingPriceType"
                           [value]="'branded'"
                           (change)="onFloorFinishingPriceTypeChange(i, floor.finishingPriceType)" />
                    Branded
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;">
                    <input type="radio"
                           name="finishingPriceType{{i}}"
                           [(ngModel)]="floor.finishingPriceType"
                           [value]="'nonbranded'"
                           (change)="onFloorFinishingPriceTypeChange(i, floor.finishingPriceType)" />
                    Non Branded
                  </label>
                </div>
                <input type="number"
                       class="company-input"
                       [(ngModel)]="floor.finishingPrice"
                       style="width:120px; margin-left:24px;"
                       aria-label="Floor finishing price (editable)" />
              </div>
              <div style="margin-top:8px; display:flex; align-items:center; gap:12px;">
                <label style="font-size:14px; font-weight:bold;">Total (Rs.)</label>
                <input type="text" class="company-input" [value]="(floor.finishingSqft || 0) * (floor.finishingPrice || 0)" readonly style="width:180px;font-weight:bold;" />
              </div>
            </div>
          </div>
        </div>
        <!-- Validation: ensure Core + Finishing does not exceed Base for this floor -->
        <div class="company-info-row" *ngIf="(((floor.coreHouseSqft || 0) + (floor.finishingSqft || 0)) > (floor.baseSqft || 0))">
          <span style="color:#d32f2f;font-weight:600;">Sum of Core House and Finishing ({{(floor.coreHouseSqft || 0) + (floor.finishingSqft || 0)}}) exceeds Total Base size ({{floor.baseSqft || 0}}).</span>
        </div>
   
        <div class="company-info-row">
          <label style="font-weight:bold;">Total Cost</label>
          <input type="text" class="company-input" [value]="(floor.coreHouseSqft * floor.coreHouseSqftPrice) + (floor.finishingSqft * floor.finishingPrice)" readonly style="width:30%;max-width:180px;font-weight:bold;" />
        </div>
        <div class="section-actions">
          <button class="company-reset-btn" type="button" (click)="resetFloorInfo(i)">Reset</button>
        </div>
      </div>
    </div>
    <!-- Add Floor Button -->
    <div style="display:flex;justify-content:center;margin:24px 0;">
      <button type="button" (click)="addFloor()" style="font-size:28px;padding:8px 24px;border-radius:50%;background:#1976d2;color:#fff;border:none;box-shadow:0 2px 8px #ccc;cursor:pointer;">
        +
      </button>
      <span style="margin-left:12px;font-size:18px;color:#1976d2;vertical-align:middle;">Add Floor</span>
    </div>
  </div>

  <!-- Bore Well Costing Section -->
  <div class="company-section">
    <div style="display: flex; align-items: center; justify-content: space-between;">
  <button class="company-toggle" type="button" (click)="toggleBoreWellCosting()" [disabled]="!isBoreWellRequired" style="flex:1;">
        <span [style.color]="isBoreWellRequired ? 'inherit' : '#aaa'">Bore Well Costing</span>
        <span class="arrow" [class.open]="showBoreWellCosting" [style.color]="isBoreWellRequired ? 'inherit' : '#aaa'">&#9660;</span>
      </button>
      <label style="font-weight:bold; margin-left: 16px; white-space:nowrap;">
        <input type="checkbox" [(ngModel)]="isBoreWellRequired" /> Required
      </label>
    </div>
    <div class="company-details" *ngIf="showBoreWellCosting && isBoreWellRequired">
      <div class="company-info-row" *ngFor="let item of boreWellItems; let i = index" style="display:flex;align-items:center;gap:16px;">
        <input type="text" class="company-input" [(ngModel)]="item.description" placeholder="Item Description" style="flex:2;" />
        <input type="number" class="company-input" [(ngModel)]="item.quantity" placeholder="Qty" style="width:80px;" />
        <span style="font-weight:bold;">x</span>
        <input type="number" class="company-input" [(ngModel)]="item.rate" placeholder="Rate" style="width:100px;" />
        <span style="font-weight:bold;">=</span>
        <input type="number" class="company-input" [value]="(item.quantity || 0) * (item.rate || 0)" readonly style="width:120px;font-weight:bold;" />
        <button type="button" (click)="deleteBoreWellItem(i)" style="background:#e53935;color:#fff;border:none;border-radius:4px;padding:4px 12px;cursor:pointer;margin-left:8px;">Delete</button>
      </div>
      <div style="display:flex;justify-content:center;margin:16px 0;">
        <button type="button" (click)="addBoreWellItem()" style="font-size:20px;padding:6px 18px;border-radius:50%;background:#1976d2;color:#fff;border:none;box-shadow:0 2px 8px #ccc;cursor:pointer;">+</button>
        <span style="margin-left:10px;font-size:16px;color:#1976d2;vertical-align:middle;">Add Item</span>
      </div>
      <div class="company-info-row" style="font-weight:bold;display:flex;align-items:center;gap:16px;margin-top:16px;">
  <span style="flex:2;">Grand Total (Excluding Motor):</span>
  <input type="number" class="company-input" [value]="grandTotalBoreWell" readonly style="flex:1;max-width:160px;font-weight:bold;" />
      </div>
      <div class="section-actions" style="margin-top:16px;">
        <button class="company-reset-btn" type="button" (click)="resetBoreWellCosting()">Reset</button>
      </div>
    </div>
  </div>
  <div class="company-section">
    <button class="company-toggle" type="button" (click)="showPaymentStructure = !showPaymentStructure">
      <span>Payment Structure</span>
      <span class="arrow" [class.open]="showPaymentStructure">&#9660;</span>
    </button>
    <div class="company-details" *ngIf="showPaymentStructure">
      <h3 style="margin-top:0;color:#1976d2;font-size:18px;font-weight:600;">Payment Schedule (Core House)</h3>
      <div class="company-info-row" *ngFor="let item of paymentScheduleCoreHouse; let i = index">
        <label>{{item.label}}</label>
        <span style="display:inline-flex;align-items:center;gap:4px;">
          <input type="number" class="company-input" [(ngModel)]="item.value" style="width:80px;" />
          <span>%</span>
        </span>
      </div>
      <h3 style="margin-top:24px;color:#1976d2;font-size:18px;font-weight:600;">Payment Schedule (Building Work)</h3>
      <div class="company-info-row" *ngFor="let item of paymentScheduleBuildingWork; let i = index">
        <label>{{item.label}}</label>
        <span style="display:inline-flex;align-items:center;gap:4px;">
          <input type="number" class="company-input" [(ngModel)]="item.value" style="width:80px;" />
          <span>%</span>
        </span>
      </div>
      <h3 style="margin-top:24px;color:#1976d2;font-size:18px;font-weight:600;">Payment Schedule (Plinth Work)</h3>
      <div class="company-info-row" *ngFor="let item of paymentSchedulePlinthWork; let i = index">
        <label>{{item.label}}</label>
        <span style="display:inline-flex;align-items:center;gap:4px;">
          <input type="number" class="company-input" [(ngModel)]="item.value" style="width:80px;" />
          <span>%</span>
        </span>
      </div>
      <h3 style="margin-top:24px;color:#1976d2;font-size:18px;font-weight:600;">Payment Schedule (Piling)</h3>
      <div class="company-info-row" *ngFor="let item of paymentSchedulePiling; let i = index">
        <label>{{item.label}}</label>
        <span style="display:inline-flex;align-items:center;gap:4px;">
          <input type="number" class="company-input" [(ngModel)]="item.value" style="width:80px;" />
          <span>%</span>
        </span>
      </div>
      <div class="section-actions" style="margin-top:24px;">
        <button class="company-reset-btn" type="button" (click)="resetPaymentStructure()">Reset</button>
      </div>
    </div>
  </div>
    <!-- Extra Work (Customer Borne) Section -->
    <div class="company-section">
      <button class="company-toggle" type="button" (click)="showExtraWork = !showExtraWork">
        <span>Extra Work (Customer Borne)</span>
        <span class="arrow" [class.open]="showExtraWork">&#9660;</span>
      </button>
      <div class="company-details" *ngIf="showExtraWork">
        <div *ngFor="let item of extraWorkItems; let i = index" class="company-info-row" style="display:flex;align-items:center;gap:12px;">
          <input type="text" class="company-input" [(ngModel)]="item.description" placeholder="Extra Work Item" />
          <button type="button" (click)="deleteExtraWorkItem(i)" style="background:#e53935;color:#fff;border:none;border-radius:4px;padding:4px 12px;cursor:pointer;">Delete</button>
        </div>
        <div style="display:flex;justify-content:center;margin:16px 0;">
          <button type="button" (click)="addExtraWorkItem()" style="font-size:20px;padding:6px 18px;border-radius:50%;background:#1976d2;color:#fff;border:none;box-shadow:0 2px 8px #ccc;cursor:pointer;">+</button>
          <span style="margin-left:10px;font-size:16px;color:#1976d2;vertical-align:middle;">Add Item</span>
        </div>
        <div class="section-actions" style="margin-top:24px;">
          <button class="company-reset-btn" type="button" (click)="resetExtraWork()">Reset</button>
        </div>
      </div>
    </div>
</div>
<!-- Floating Generate Quotation Button (always visible, after all sections) -->
</div>
<div class="generate-quote-bottom" *ngIf="!showQuotationSummary" role="region" aria-label="Generate quotation">
  <button type="button" class="generate-btn" (click)="generateQuotation()">
    <span style="display:inline-block;vertical-align:middle;font-weight:600;">Generate Quotation</span>
  </button>
</div>
